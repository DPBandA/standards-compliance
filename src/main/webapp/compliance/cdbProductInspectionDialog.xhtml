<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">

    <p:remoteCommand  name="updateSelectedShippingContainers"
                      update=":productDialogForm:productDialogTabView:productShippingContainerNumber"
                      action="#{complianceManager.updateProductShippingContainers()}"/>  

    <p:dialog width="750"
              height="600"
              modal="true"
              draggable="true"    
              closable="false"
              widgetVar="productDialog"                  
              header="Product Inspection" >
        <p:scrollPanel style="width:735px;height:475px" mode="native">
            <p:commandButton value="Ok"
                             actionListener="#{complianceManager.okProductInspection}"
                             onstart="longProcessDialogVar.show();"
                             update="#{complianceManager.productTablesToUpdate}"
                             icon="ui-icon ui-icon-check"
                             process="@form"/>

            <p:commandButton value="Cancel"
                             onstart="longProcessDialogVar.show();"
                             oncomplete="productDialog.hide();longProcessDialogVar.hide();productDialogTabViewVar.select(0);"                            
                             icon="ui-icon ui-icon-cancel"/>
            <hr/>
            <p:tabView id="productDialogTabView"
                       dynamic="false"
                       widgetVar="productDialogTabViewVar">
                <p:ajax event="tabChange"    
                        onstart="longProcessDialogVar.show();"
                        oncomplete="longProcessDialogVar.hide();"/>

                <p:tab title="Product detail">
                    <h:panelGrid columns="2" cellpadding="3" >

                        <h:outputText value="Name *: " />
                        <p:inputText value="#{complianceManager.currentProductInspection.name}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>     

                        <h:outputText value="Product Category *:" />
                        <h:selectOneMenu value="#{complianceManager.currentProductInspection.productCategory}" >
                            <p:ajax
                                global="false"                            
                                listener="#{complianceManager.updateJob}"  
                                process="@this" />
                            <f:selectItems value="#{complianceManager.productCategories}" />
                        </h:selectOneMenu>     

                        <h:outputText value="Manufacturer: " />
                        <p:autoComplete maxResults="12"                                       
                                        value="#{complianceManager.currentProductInspection.manufacturer.name}"                                                                     
                                        completeMethod="#{complianceManager.completeManufacturerName}" >
                            <p:ajax event="itemSelect"                                    
                                    listener="#{complianceManager.updateProductManufacturerForProductInsp}"
                                    process="@this"/>

                            <p:ajax event="keyup"                                   
                                    listener="#{complianceManager.updateProductManufacturerForProductInsp}"
                                    process="@this"/>
                        </p:autoComplete>                       

                        <h:outputText value="Brand: " />
                        <p:inputText value="#{complianceManager.currentProductInspection.brand}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>        

                        <h:outputText value="Model: " />
                        <p:inputText value="#{complianceManager.currentProductInspection.model}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>    

                        <h:outputText value="Serial No.: " />
                        <p:inputText value="#{complianceManager.currentProductInspection.serialNumber}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>   

                        <h:outputText value="Tariff Code:" />
                        <p:inputText value="#{complianceManager.currentProductInspection.tariffCode}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>  

                        <p:selectCheckboxMenu id="productShippingContainers" 
                                              value="#{complianceManager.selectedContainerNumbers}" 
                                              label="Select shipping container(s)"                                              
                                              filter="true" 
                                              style="vertical-align: bottom;"
                                              filterMatchMode="startsWith" 
                                              onHide="updateSelectedShippingContainers();"
                                              panelStyle="width:250px">

                            <f:selectItems value="#{complianceManager.allShippingContainers}" />
                        </p:selectCheckboxMenu>
                        <h:panelGroup>                           
                            <p:inputText value="#{complianceManager.currentProductInspection.containerNumber}"     
                                            id="productShippingContainerNumber"                                            
                                            size="35" >
                               <p:ajax event="keyup"                                   
                                        listener="#{complianceManager.updateJob}"
                                        process="@this"/>
                            </p:inputText>                             
                        </h:panelGroup>

                        <h:outputText value="Product Group Package Type: " />
                        <p:inputText value="#{complianceManager.currentProductInspection.productGroupPackageType}"
                                     title="Enter the package group type. E.g. case, palette"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>     

                        <h:outputText value=" Product Package Type: " />
                        <p:inputText value="#{complianceManager.currentProductInspection.productPackageType}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>

                        <h:outputText value="No. of Products per Group Package: " />                       
                        <p:spinner  value="#{complianceManager.currentProductInspection.numProductsPerGroupPackage}" 
                                    stepFactor="1"
                                    min="0">
                            <p:ajax listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:spinner>  

                        <h:outputText value="Product Quantity: " /> 
                        <p:spinner  value="#{complianceManager.currentProductInspection.quantity}" 
                                    stepFactor="1"
                                    min="0">
                            <p:ajax listener="#{complianceManager.updateJob}"
                                    process="@this"/> 
                        </p:spinner>  

                        <h:outputText value="No. Products Sampled: " />                       
                        <p:spinner  value="#{complianceManager.currentProductInspection.numProductsSampled}" 
                                    stepFactor="1"
                                    min="0">
                            <p:ajax listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:spinner>  

                        <h:outputText value="Sampled for: " />
                        <h:panelGrid columns="6">
                            <h:outputText value="Label Assessment: " />
                            <p:selectBooleanCheckbox value="#{complianceManager.currentProductInspection.sampledForLabelAssessment}">
                                <p:ajax listener="#{complianceManager.updateJob}"/>
                            </p:selectBooleanCheckbox>

                            <h:outputText value="   Testing: " />                            
                            <p:selectBooleanCheckbox value="#{complianceManager.currentProductInspection.sampledForTesting}">
                                <p:ajax listener="#{complianceManager.updateJob}"/>
                            </p:selectBooleanCheckbox>

                            <h:outputText value="   Investigation: " />
                            <p:selectBooleanCheckbox value="#{complianceManager.currentProductInspection.sampledForInvestigation}">
                                <p:ajax listener="#{complianceManager.updateJob}"/>
                            </p:selectBooleanCheckbox>
                        </h:panelGrid>


                    </h:panelGrid>
                </p:tab>

                <p:tab title="Checklist">
                    <h:panelGrid columns="3" cellpadding="5">
                        <h:outputText value="Country of Origin: " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentProductInspection.hasCountryOfOrigin}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>

                        <h:selectOneMenu value="#{complianceManager.currentProductInspection.countryOfOrigin}" >
                            <p:ajax                               
                                listener="#{complianceManager.updateJob}"
                                process="@this" />
                            <f:selectItems value="#{complianceManager.countries}" />
                        </h:selectOneMenu>
                        <ui:remove>
                            <p:inputText value="#{complianceManager.currentProductInspection.countryOfOrigin}"
                                         style="font-weight: bold;width: 300px" >
                                <p:ajax event="keyup"
                                        global="false"
                                        listener="#{complianceManager.updateJob}"
                                        process="@this"/>
                            </p:inputText>
                        </ui:remove>

                        <h:outputText value="Name of Distributor: " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentProductInspection.hasBusinessSource}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>                       
                        <p:autoComplete maxResults="12"                                       
                                        value="#{complianceManager.currentProductInspection.distributor.name}"                                                                     
                                        completeMethod="#{complianceManager.completeDistributorName}" >
                            <p:ajax event="itemSelect"                                    
                                    listener="#{complianceManager.updateProductDistributorForProductInsp}"
                                    process="@this"/>

                            <p:ajax event="keyup"                                   
                                    listener="#{complianceManager.updateProductDistributorForProductInsp}"
                                    process="@this"/>
                        </p:autoComplete>                   
                        <ui:remove>
                            <p:inputText value="#{complianceManager.currentProductInspection.businessSource.name}"
                                         style="font-weight: bold;width: 300px" >
                                <p:ajax event="keyup"
                                        global="false"
                                        listener="#{complianceManager.updateJob}"
                                        process="@this"/>
                            </p:inputText>
                        </ui:remove>

                        <h:outputText value="Net Quantity Declaration in Metric: " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentProductInspection.hasQuantityDescription}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>
                        <p:inputText value="#{complianceManager.currentProductInspection.quantityDescription}"
                                     style="font-weight: bold;width: 300px" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>

                        <h:outputText value="Ingredient Listing: " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentProductInspection.hasIngredients}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>
                        <p:inputText value="#{complianceManager.currentProductInspection.ingredients}"
                                     style="width: 300px"                                        
                                     maxlength="1000">
                            <p:ajax event="keyup"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>

                        <h:outputText value="Instructions: " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentProductInspection.hasInstructions}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>
                        <p:inputText value="#{complianceManager.currentProductInspection.instructions}"
                                     style="width: 300px"
                                     maxlength="1000">
                            <p:ajax event="keyup"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>

                        <h:outputText value="Pictorial Representation: " />
                        <p:selectBooleanCheckbox value="#{complianceManager.currentProductInspection.hasPictorialRepresentation}">
                            <p:ajax listener="#{complianceManager.updateJob}"/>
                        </p:selectBooleanCheckbox>                            

                    </h:panelGrid>

                    <h:panelGrid columns="2" cellspacing="5">
                        <h:outputText value="Batch code: " />
                        <p:inputText value="#{complianceManager.currentProductInspection.batchCode}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>

                        <h:outputText value="Date mark: " />
                        <p:inputText value="#{complianceManager.currentProductInspection.dateMark}"
                                     style="font-weight: bold;" >
                            <p:ajax event="keyup"
                                    global="false"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>

                        <h:outputText value="Precaution statement:"  />
                        <p:inputText value="#{complianceManager.currentProductInspection.precautionStatement}"
                                     style="width: 350px"
                                     maxlength="1000">
                            <p:ajax event="keyup"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>

                        <h:outputText value="Status:" />
                        <h:selectOneMenu value="#{complianceManager.currentProductInspection.status}" >
                            <p:ajax
                                global="true"
                                listener="#{complianceManager.updateJob}"
                                process="@this" />
                            <f:selectItems value="#{complianceManager.productStatus}" />
                        </h:selectOneMenu>

                        <h:outputText value="Comment: " />                            
                        <p:inputText value="#{complianceManager.currentProductInspection.comments}"
                                     style="width: 350px"
                                     maxlength="1000">
                            <p:ajax event="keyup"
                                    listener="#{complianceManager.updateJob}"
                                    process="@this"/>
                        </p:inputText>
                    </h:panelGrid>

                    <ui:remove>
                        <hr/>
                        <h:panelGrid columns="2">
                            <h:outputText value="Product image: " />
                            <h:panelGroup>
                                <h:panelGrid columns="2">
                                    <p:inputText value="#{complianceManager.currentProductInspection.imageURL}"
                                                 id="imageURL"
                                                 readonly="true"
                                                 style="font-weight: bold;width: 300px" >
                                        <p:ajax event="keyup"
                                                global="false"
                                                listener="#{complianceManager.updateJob}"
                                                process="@this"/>                           
                                    </p:inputText>

                                    <p:commandButton id="downloadImageButton" value="Download" ajax="false" 
                                                     onclick="longProcessDialogVar2.show();"   
                                                     disabled="#{!complianceManager.marketProductImageIsValid}"
                                                     icon="ui-icon-arrowthichk-s">  
                                        <p:fileDownload value="#{complianceManager.getCurrentProductInspectionImageDownload}" />
                                    </p:commandButton> 
                                </h:panelGrid>

                                <p:fileUpload fileUploadListener="#{complianceManager.handleProductPhotoFileUpload}" 
                                              onstart="longProcessDialogVar.show();"
                                              oncomplete="longProcessDialogVar.hide();"
                                              multiple="false"
                                              update="imageURL,downloadImageButton"
                                              allowTypes="/(\.|\/)(gif|jpe?g|png)$/" />


                            </h:panelGroup>
                        </h:panelGrid>
                    </ui:remove>
                </p:tab>

            </p:tabView>
            <hr/>
            <p:commandButton value="Ok"
                             actionListener="#{complianceManager.okProductInspection}"
                             onstart="longProcessDialogVar.show();"
                             update="#{complianceManager.productTablesToUpdate}"
                             icon="ui-icon ui-icon-check"
                             process="@form"/>

            <p:commandButton value="Cancel"
                             onstart="longProcessDialogVar.show();"
                             oncomplete="productDialog.hide();longProcessDialogVar.hide();productDialogTabViewVar.select(0);"                            
                             icon="ui-icon ui-icon-cancel"/>
        </p:scrollPanel>
    </p:dialog>   

    <p:confirmDialog severity="alert"
                     closable="false"
                     message="Are you sure you wish to delete this product?"
                     header="Delete Product?"
                     widgetVar="deleteProductDialog"
                     width="400">
        <p:commandButton value="Yes"
                         actionListener="#{complianceManager.removeProductInspection}"
                         update="#{complianceManager.productTablesToUpdate}"
                         oncomplete="deleteProductDialog.hide();"
                         icon="ui-icon-check"/>
        <p:commandButton value="No"
                         oncomplete="deleteProductDialog.hide();"
                         icon="ui-icon-cancel"/>
    </p:confirmDialog>
</html>
